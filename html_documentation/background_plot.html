<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.7.2" />
<title>background_plot API documentation</title>
<meta name="description" content="" />
<link href='https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.0/normalize.min.css' rel='stylesheet'>
<link href='https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/8.0.0/sanitize.min.css' rel='stylesheet'>
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" rel="stylesheet">
<style>.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{font-weight:bold}#index h4 + ul{margin-bottom:.6em}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>background_plot</code></h1>
</header>
<section id="section-intro">
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">import numpy as np
import pandas as pd
from astropy.io import fits
from matplotlib import pyplot as plt
from pandas.plotting import register_matplotlib_converters
register_matplotlib_converters()
from datetime import timedelta


class Input:
    def __init__(self, file):
        data1, data2, header3, header1 = self.__load_data(file)

        # Define the parameters from HEADER and DATA
        self.rate = data1.RATE
        self.Time = data1.TIME
        self.Time2 = data1.TIME - 2
        self.Livetime = data1.LIVETIME
        self.Time_del = data1.TIMEDEL
        self.Channel = data1.CHANNEL
        self.E_min = data2.E_MIN
        self.E_max = data2.E_MAX
        self.time_len = len(self.Time)
        self.Area = header3[24]
        self.Date_start = header3[17]
        self.Date_end = header3[18]
        self.E1 = self.E_min[3] - self.E_min[0]
        self.E2 = self.E_min[9] - self.E_min[3]
        self.E3 = self.E_min[22] - self.E_min[9]
        self.E4 = self.E_min[40] - self.E_min[22]
        self.E5 = self.E_min[57] - self.E_min[40]
        self.E6 = self.E_min[76] - self.E_min[57]
        self.E_mean = np.mean(self.E_min)
        self.sum = sum(self.Time_del)
        self.detectors = str(header1[25])[10:]


        # Time format conversion (from sec to h/m/sec/)
        #self.TimeNew = pd.to_datetime(self.Time, unit=&#39;s&#39;)

        # Time -2
        self.TimeNew2 = pd.to_datetime(self.Time2, unit=&#39;s&#39;)

        self.TimeNew22 = np.array(self.TimeNew2)
        self.x_position = str(self.TimeNew2[70])


        #
        self.t1 = pd.to_timedelta(self.Time2, unit=&#39;s&#39;)
        #self.t1 = map(self.t1, float)

        self.t2 = np.array([str(timedelta(seconds=s)) for s in self.Time])

    def __load_data(self, file):
        hdulist = fits.open(file)
        hdulist.info()
        return hdulist[1].data, hdulist[2].data, hdulist[1].header, hdulist[3].header

    # Define the Rate for &#34;Plot Time Profile&#34;
    def __get_rate_data(self):
        data = np.zeros(shape=(self.time_len, 6))
        for i in range(self.time_len):
            data[i, 0] = sum(self.rate[i, 0:3])
            data[i, 1] = sum(self.rate[i, 3:9])
            data[i, 2] = sum(self.rate[i, 9:22])
            data[i, 3] = sum(self.rate[i, 22:40])
            data[i, 4] = sum(self.rate[i, 40:57])
            data[i, 5] = sum(self.rate[i, 57:76])
        return data

    # Define the Counts for &#34;Plot Time Profile&#34;
    def __get_counts_data(self):
        data = np.zeros(shape=(self.time_len, 6))
        for i in range(self.time_len):
            data[i, 0] = sum(self.rate[i, 0:3]) * self.Time_del[i]
            data[i, 1] = sum(self.rate[i, 3:9]) * self.Time_del[i]
            data[i, 2] = sum(self.rate[i, 9:22]) * self.Time_del[i]
            data[i, 3] = sum(self.rate[i, 22:40]) * self.Time_del[i]
            data[i, 4] = sum(self.rate[i, 40:57]) * self.Time_del[i]
            data[i, 5] = sum(self.rate[i, 57:76]) * self.Time_del[i]
        return data

    # Define the Flux for &#34;Plot Time Profile&#34;
    def __get_flux_data(self):
        data = np.zeros(shape=(self.time_len, 6))
        for i in range(self.time_len):
            data[i, 0] = sum(self.rate[i, 0:3]) / (self.Area * self.E1)
            data[i, 1] = sum(self.rate[i, 3:9]) / (self.Area * self.E2)
            data[i, 2] = sum(self.rate[i, 9:22]) / (self.Area * self.E3)
            data[i, 3] = sum(self.rate[i, 22:40]) / (self.Area * self.E4)
            data[i, 4] = sum(self.rate[i, 40:57]) / (self.Area * self.E5)
            data[i, 5] = sum(self.rate[i, 57:76]) / (self.Area * self.E6)
        return data

    # 1. Plot Time Profile for Rate, Counts, Flux

    def __time_profile_plotting(self, data, xlabel, title, show=True, name=None):
        df = pd.DataFrame(data, index=self.TimeNew2,
                        columns=[&#39;3-6keV(Data with Bk)&#39;, &#39;6-12keV(Data with Bk)&#39;, &#39;12-25keV(Data with Bk)&#39;,
                                  &#39;25-49keV(Data with Bk)&#39;, &#39;49-100keV(Data with Bk)&#39;, &#39;100-250keV(Data with Bk)&#39;])
        print(&#39;self timmmme&#39;, type(self.TimeNew2[0:3]), self.TimeNew2[0:3])
        print(&#39;datassss&#39;, type(data), data)
        #print(&#39;dffffff&#39;, type(df), df)
        #datas = np.zeros(shape=(self.time_len, 1))
        #for i in range(self.time_len):
        #   datas[i, 0] = sum(self.rate[i, 0:3])
        #df = pd.DataFrame(data[:,0], index=self.TimeNew2,columns=[&#39;3-6keV(Data with Bk)&#39;])
        
        colors = [&#39;gray&#39;,&#39;magenta&#39;,&#39;lime&#39;, &#39;cyan&#39;, &#39;yellow&#39;, &#39;red&#39;]
        #df.style.set_properties(subset=[&#39;columns&#39;], **{&#39;height&#39;: &#39;50px&#39;})
        df.plot(figsize=(8, 8), drawstyle=&#39;steps-post&#39;, color = colors)
        #df.plot(figsize=(3, 3), drawstyle=&#39;steps-post&#39;, color = [&#39;cyan&#39;])
        # Define where the steps should be placed: &#39;steps-pre&#39;: The y value is continued constantly to the left from
        # every x position, i.e. the interval (x[i-1], x[i]] has the value y[i] &#39;steps-post&#39;: The y value is
        # continued constantly to the right from every x position, i.e. the interval [x[i], x[i+1]) has the value y[
        # i] &#39;steps-mid&#39;: Steps occur half-way between the x positions.
        #plt.rc(&#39;legend&#39;, labelsize=6)
        plt.yscale(&#39;log&#39;)
        plt.xlabel(&#39;Start time: &#39; + str(self.Date_start))
        plt.ylabel(xlabel)
        plt.title(title)
        #plt.text(self.x_position, 166, &#39;Detectors: &#39; + self.detectors) #rate
        #plt.text(self.x_position, 664, &#39;Detectors: &#39; + self.detectors)  # counts
        #plt.text(self.x_position, 0.023, &#39;Detectors: &#39; + self.detectors) #flux
        if show:
            plt.show()
        if name:
            plt.savefig(name, format=&#39;png&#39;)

    # RATE vs Time
    def rate_vs_time_plotting(self):
        rate_data = self.__get_rate_data()
        self.__time_profile_plotting(rate_data, &#39;counts/s&#39;, &#39;SPEX HESSI Count Rate vs Time&#39;)

    # COUNTS vs Time
    def counts_vs_time_plotting(self):
        count_data = self.__get_counts_data()

        self.__time_profile_plotting(count_data, &#39;counts&#39;, &#39;SPEX HESSI Counts vs Time&#39;)

    # FLUX vs Time
    def flux_vs_time_plotting(self):
        flux_data = self.__get_flux_data()
        self.__time_profile_plotting(flux_data, &#39;counts s^(-1) cm^(-2) keV^(-1)&#39;, &#39;SPEX HESSI Count Flux vs Time&#39;)
        colors = [&#39;gray&#39;,&#39;magenta&#39;,&#39;lime&#39;, &#39;cyan&#39;, &#39;yellow&#39;, &#39;red&#39;]
    def backg_plot_vs_time(self, plotUnit, i, xlabel= &#39;counts&#39;, title=&#39;SPEX HESSI Count&#39;, show=True, name=None):

        columns=[&#39;3-6keV(Data with Bk)&#39;, &#39;6-12keV(Data with Bk)&#39;, &#39;12-25keV(Data with Bk)&#39;,
                                  &#39;25-49keV(Data with Bk)&#39;, &#39;49-100keV(Data with Bk)&#39;, &#39;100-250keV(Data with Bk)&#39;]
        if plotUnit == &#39;rate&#39;:
            data=self.__get_rate_data()
            title += &#39; Rate vs Time&#39;
        elif plotUnit == &#39;flux&#39;:
            data=self.__get_flux_data()
            title += &#39; Flux vs Time&#39;
        elif plotUnit == &#39;counts&#39;:
            data=self.__get_counts_data()
            title += &#39; Counts vs Time&#39; 
             
        if i == 0:
            datas=data[:,0]
            plotColor = &#39;gray&#39;
        elif i == 1:
            datas=data[:,1]
            plotColor = &#39;magenta&#39;
        elif i == 2:
            datas=data[:,2]
            plotColor = &#39;lime&#39;
        elif i == 3:
            datas=data[:,3]
            plotColor = &#39;cyan&#39;
        elif i == 4:
            datas=data[:,4]
            plotColor = &#39;yellow&#39;
        elif i == 5:
            datas=data[:,5]
            plotColor = &#39;red&#39;
        
        df = pd.DataFrame(datas, index=self.TimeNew2,columns=[columns[i]])
        colors = [&#39;gray&#39;,&#39;magenta&#39;,&#39;lime&#39;, &#39;cyan&#39;, &#39;yellow&#39;, &#39;red&#39;]
        df.plot(figsize=(3, 3), drawstyle=&#39;steps-post&#39;, color = [plotColor])
        plt.yscale(&#39;log&#39;)
        plt.xlabel(&#39;Start time: &#39; + str(self.Date_start))
        plt.ylabel(xlabel)
        plt.title(title)
        if show:
            plt.show()
        if name:
            plt.savefig(name, format=&#39;png&#39;)

            
    # 2. Plot Spectrum
    def __plot_spectrum(self, typ):
        n = len(self.E_min)
        data = np.zeros(shape=n)
        # Define Rate for &#34;Plot Spectrum&#34;
        if typ == &#39;rate&#39;:
            for i in range(n):
                data[i] = np.mean(self.rate[:, i])
                plt.rcParams[&#34;figure.figsize&#34;] = [8, 8]
                plt.text(20.8146, 8.1881, &#39;Detectors: &#39; + self.detectors,
                         fontdict={&#39;fontsize&#39;: 8, &#39;fontweight&#39;: &#39;medium&#39;})
                plt.text(11.4332, 6.71774, self.Date_start + &#39; to &#39; + self.Date_end,
                         fontdict={&#39;fontsize&#39;: 8, &#39;fontweight&#39;: &#39;medium&#39;})
                plt.xlabel(&#39;Energy(keV)&#39;)
                plt.ylabel(&#39;counts/s&#39;)
                plt.title(&#39;SPEX HESSI Count Rate vs Energy&#39;)
        # Define Counts for &#34;Plot Spectrum&#34;
        elif typ == &#39;counts&#39;:
            for i in range(n):
                data[i] = np.mean(self.rate[:, i] * self.sum)
                plt.rcParams[&#34;figure.figsize&#34;] = [8, 8]
                plt.text(26, 5100, &#39;Detectors: &#39; + self.detectors, fontdict={&#39;fontsize&#39;: 8, &#39;fontweight&#39;: &#39;medium&#39;})
                plt.text(11.9, 4353.52, self.Date_start + &#39; to &#39; + self.Date_end,
                         fontdict={&#39;fontsize&#39;: 8, &#39;fontweight&#39;: &#39;medium&#39;})
                plt.xlabel(&#39;Energy(keV)&#39;)
                plt.ylabel(&#39;counts&#39;)
                plt.title(&#39;SPEX HESSI Counts vs Energy&#39;)
        # Define Flux for &#34;Plot Spectrum&#34;
        elif typ == &#39;flux&#39;:
            deltaE = np.zeros(shape=(n))
            for i in range(n):
                deltaE[i] = self.E_max[i] - self.E_min[i]

            for i in range(n):
                data[i] = np.mean(self.rate[:, i]) / (self.Area * deltaE[i]-2)
                plt.rcParams[&#34;figure.figsize&#34;] = [8, 8]
                plt.text(32, 0.029, &#39;Detectors: &#39; + self.detectors, fontdict={&#39;fontsize&#39;: 8, &#39;fontweight&#39;: &#39;medium&#39;})
                plt.text(11.9, 0.023, self.Date_start + &#39; to &#39; + self.Date_end,
                         fontdict={&#39;fontsize&#39;: 8, &#39;fontweight&#39;: &#39;medium&#39;})
                plt.xlabel(&#39;Energy(keV)&#39;)
                plt.ylabel(&#39;counts s^(-1) cm^(-2) keV^(-1)&#39;)
                plt.title(&#39;SPEX HESSI Count Flux vs Energy&#39;)
        else:
            print(&#39;error&#39;)
            return

        plt.plot(self.E_min, data, drawstyle=&#39;steps-post&#39;)
        plt.yscale(&#39;log&#39;)
        plt.xscale(&#39;log&#39;)
        plt.show()

    # Plot Spectrum for Rate, Counts, Flux
    # Spectrum for Rate
    def plot_spectrum_rate(self):
        self.__plot_spectrum(&#39;rate&#39;)

    # Spectrum for Counts
    def plot_spectrum_counts(self):
        self.__plot_spectrum(&#39;counts&#39;)

    # Spectrum for Flux
    def plot_spectrum_flux(self):
        self.__plot_spectrum(&#39;flux&#39;)

    # 3. Plot Spectrogram
    def __plot_spectrogram(self, typ):
        tick = np.array([str(timedelta(seconds=s)) for s in self.Time2])
        #X, Y = np.meshgrid(tick, self.E_min)
        # Define Rate for Plot Spectrogram
        if typ == &#39;rate&#39;:
            plt.pcolormesh(tick, self.E_min, np.transpose(self.rate), cmap=&#39;gray_r&#39;)
            # plt.xticks(np.arange(min(self.TimeNew), max(self.TimeNew), 1.0))
            plt.xlabel(&#39;Start Time: &#39; + self.Date_start)
            plt.ylabel(&#39;keV&#39;)
            plt.title(&#39;SPEX HESSI Count Rate Spectrogram&#39;)

        # Define Counts for Plot Spectrogram
        elif typ == &#39;counts&#39;:
            plt.pcolormesh(tick, self.E_min, np.transpose(self.rate) * self.sum, cmap=&#39;gray_r&#39;)
            plt.xlabel(&#39;Start Time: &#39; + self.Date_start)
            plt.ylabel(&#39;keV&#39;)
            plt.title(&#39;SPEX HESSI Counts Spectrogram&#39;)



        # Define Flux for Plot Spectrogram
        elif typ == &#39;flux&#39;:
            n = len(self.E_min)
            deltaE = np.zeros(shape=(n))
            for i in range(n):
                deltaE[i] = self.E_max[i] - self.E_min[i]
            plt.pcolormesh(tick, self.E_min, np.transpose(self.rate) / (self.Area * deltaE[i]), cmap=&#39;gray_r&#39;)
            plt.xlabel(&#39;Start Time: &#39; + self.Date_start)
            plt.ylabel(&#39;keV&#39;)
            plt.title(&#39;SPEX HESSI Count Flux Spectrogram&#39;)


        else:
            print(&#39;error&#39;)
            return
        #plt.axis([self.TimeNew2[0], self.TimeNew2[-1], 1, 1000])

        # plt.xsticks(rotation = 90)
        T = len(tick)/5
        plt.colorbar()
        plt.yscale(&#39;log&#39;)
        plt.yticks([1, 1000])
        plt.xticks(np.arange(len(tick), step = T)) # for 1st data: step = 30 # , rotation = 90)
        plt.show()


    # Plot Spectrogram
    # Spectrogram for Rate
    def plot_spectrogram_rate(self):
        self.__plot_spectrogram(&#39;rate&#39;)

    # Spectrogram for Counts
    def plot_spectrogram_counts(self):
        self.__plot_spectrogram(&#39;counts&#39;)

    # Spectrogram for Flux
    def plot_spectrogram_flux(self):
        self.__plot_spectrogram(&#39;flux&#39;)


# testing
if __name__ == &#39;__main__&#39;:
    plots = Input(&#34;.fits&#34;)
    plots.rate_vs_time_plotting()
    plots.counts_vs_time_plotting()
    plots.flux_vs_time_plotting()
    plots.plot_spectrum_rate()
    plots.plot_spectrum_counts()
    plots.plot_spectrum_flux()
    plots.plot_spectrogram_rate()
    plots.plot_spectrogram_counts()
    plots.plot_spectrogram_flux()</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="background_plot.Input"><code class="flex name class">
<span>class <span class="ident">Input</span></span>
<span>(</span><span>file)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class Input:
    def __init__(self, file):
        data1, data2, header3, header1 = self.__load_data(file)

        # Define the parameters from HEADER and DATA
        self.rate = data1.RATE
        self.Time = data1.TIME
        self.Time2 = data1.TIME - 2
        self.Livetime = data1.LIVETIME
        self.Time_del = data1.TIMEDEL
        self.Channel = data1.CHANNEL
        self.E_min = data2.E_MIN
        self.E_max = data2.E_MAX
        self.time_len = len(self.Time)
        self.Area = header3[24]
        self.Date_start = header3[17]
        self.Date_end = header3[18]
        self.E1 = self.E_min[3] - self.E_min[0]
        self.E2 = self.E_min[9] - self.E_min[3]
        self.E3 = self.E_min[22] - self.E_min[9]
        self.E4 = self.E_min[40] - self.E_min[22]
        self.E5 = self.E_min[57] - self.E_min[40]
        self.E6 = self.E_min[76] - self.E_min[57]
        self.E_mean = np.mean(self.E_min)
        self.sum = sum(self.Time_del)
        self.detectors = str(header1[25])[10:]


        # Time format conversion (from sec to h/m/sec/)
        #self.TimeNew = pd.to_datetime(self.Time, unit=&#39;s&#39;)

        # Time -2
        self.TimeNew2 = pd.to_datetime(self.Time2, unit=&#39;s&#39;)

        self.TimeNew22 = np.array(self.TimeNew2)
        self.x_position = str(self.TimeNew2[70])


        #
        self.t1 = pd.to_timedelta(self.Time2, unit=&#39;s&#39;)
        #self.t1 = map(self.t1, float)

        self.t2 = np.array([str(timedelta(seconds=s)) for s in self.Time])

    def __load_data(self, file):
        hdulist = fits.open(file)
        hdulist.info()
        return hdulist[1].data, hdulist[2].data, hdulist[1].header, hdulist[3].header

    # Define the Rate for &#34;Plot Time Profile&#34;
    def __get_rate_data(self):
        data = np.zeros(shape=(self.time_len, 6))
        for i in range(self.time_len):
            data[i, 0] = sum(self.rate[i, 0:3])
            data[i, 1] = sum(self.rate[i, 3:9])
            data[i, 2] = sum(self.rate[i, 9:22])
            data[i, 3] = sum(self.rate[i, 22:40])
            data[i, 4] = sum(self.rate[i, 40:57])
            data[i, 5] = sum(self.rate[i, 57:76])
        return data

    # Define the Counts for &#34;Plot Time Profile&#34;
    def __get_counts_data(self):
        data = np.zeros(shape=(self.time_len, 6))
        for i in range(self.time_len):
            data[i, 0] = sum(self.rate[i, 0:3]) * self.Time_del[i]
            data[i, 1] = sum(self.rate[i, 3:9]) * self.Time_del[i]
            data[i, 2] = sum(self.rate[i, 9:22]) * self.Time_del[i]
            data[i, 3] = sum(self.rate[i, 22:40]) * self.Time_del[i]
            data[i, 4] = sum(self.rate[i, 40:57]) * self.Time_del[i]
            data[i, 5] = sum(self.rate[i, 57:76]) * self.Time_del[i]
        return data

    # Define the Flux for &#34;Plot Time Profile&#34;
    def __get_flux_data(self):
        data = np.zeros(shape=(self.time_len, 6))
        for i in range(self.time_len):
            data[i, 0] = sum(self.rate[i, 0:3]) / (self.Area * self.E1)
            data[i, 1] = sum(self.rate[i, 3:9]) / (self.Area * self.E2)
            data[i, 2] = sum(self.rate[i, 9:22]) / (self.Area * self.E3)
            data[i, 3] = sum(self.rate[i, 22:40]) / (self.Area * self.E4)
            data[i, 4] = sum(self.rate[i, 40:57]) / (self.Area * self.E5)
            data[i, 5] = sum(self.rate[i, 57:76]) / (self.Area * self.E6)
        return data

    # 1. Plot Time Profile for Rate, Counts, Flux

    def __time_profile_plotting(self, data, xlabel, title, show=True, name=None):
        df = pd.DataFrame(data, index=self.TimeNew2,
                        columns=[&#39;3-6keV(Data with Bk)&#39;, &#39;6-12keV(Data with Bk)&#39;, &#39;12-25keV(Data with Bk)&#39;,
                                  &#39;25-49keV(Data with Bk)&#39;, &#39;49-100keV(Data with Bk)&#39;, &#39;100-250keV(Data with Bk)&#39;])
        print(&#39;self timmmme&#39;, type(self.TimeNew2[0:3]), self.TimeNew2[0:3])
        print(&#39;datassss&#39;, type(data), data)
        #print(&#39;dffffff&#39;, type(df), df)
        #datas = np.zeros(shape=(self.time_len, 1))
        #for i in range(self.time_len):
        #   datas[i, 0] = sum(self.rate[i, 0:3])
        #df = pd.DataFrame(data[:,0], index=self.TimeNew2,columns=[&#39;3-6keV(Data with Bk)&#39;])
        
        colors = [&#39;gray&#39;,&#39;magenta&#39;,&#39;lime&#39;, &#39;cyan&#39;, &#39;yellow&#39;, &#39;red&#39;]
        #df.style.set_properties(subset=[&#39;columns&#39;], **{&#39;height&#39;: &#39;50px&#39;})
        df.plot(figsize=(8, 8), drawstyle=&#39;steps-post&#39;, color = colors)
        #df.plot(figsize=(3, 3), drawstyle=&#39;steps-post&#39;, color = [&#39;cyan&#39;])
        # Define where the steps should be placed: &#39;steps-pre&#39;: The y value is continued constantly to the left from
        # every x position, i.e. the interval (x[i-1], x[i]] has the value y[i] &#39;steps-post&#39;: The y value is
        # continued constantly to the right from every x position, i.e. the interval [x[i], x[i+1]) has the value y[
        # i] &#39;steps-mid&#39;: Steps occur half-way between the x positions.
        #plt.rc(&#39;legend&#39;, labelsize=6)
        plt.yscale(&#39;log&#39;)
        plt.xlabel(&#39;Start time: &#39; + str(self.Date_start))
        plt.ylabel(xlabel)
        plt.title(title)
        #plt.text(self.x_position, 166, &#39;Detectors: &#39; + self.detectors) #rate
        #plt.text(self.x_position, 664, &#39;Detectors: &#39; + self.detectors)  # counts
        #plt.text(self.x_position, 0.023, &#39;Detectors: &#39; + self.detectors) #flux
        if show:
            plt.show()
        if name:
            plt.savefig(name, format=&#39;png&#39;)

    # RATE vs Time
    def rate_vs_time_plotting(self):
        rate_data = self.__get_rate_data()
        self.__time_profile_plotting(rate_data, &#39;counts/s&#39;, &#39;SPEX HESSI Count Rate vs Time&#39;)

    # COUNTS vs Time
    def counts_vs_time_plotting(self):
        count_data = self.__get_counts_data()

        self.__time_profile_plotting(count_data, &#39;counts&#39;, &#39;SPEX HESSI Counts vs Time&#39;)

    # FLUX vs Time
    def flux_vs_time_plotting(self):
        flux_data = self.__get_flux_data()
        self.__time_profile_plotting(flux_data, &#39;counts s^(-1) cm^(-2) keV^(-1)&#39;, &#39;SPEX HESSI Count Flux vs Time&#39;)
        colors = [&#39;gray&#39;,&#39;magenta&#39;,&#39;lime&#39;, &#39;cyan&#39;, &#39;yellow&#39;, &#39;red&#39;]
    def backg_plot_vs_time(self, plotUnit, i, xlabel= &#39;counts&#39;, title=&#39;SPEX HESSI Count&#39;, show=True, name=None):

        columns=[&#39;3-6keV(Data with Bk)&#39;, &#39;6-12keV(Data with Bk)&#39;, &#39;12-25keV(Data with Bk)&#39;,
                                  &#39;25-49keV(Data with Bk)&#39;, &#39;49-100keV(Data with Bk)&#39;, &#39;100-250keV(Data with Bk)&#39;]
        if plotUnit == &#39;rate&#39;:
            data=self.__get_rate_data()
            title += &#39; Rate vs Time&#39;
        elif plotUnit == &#39;flux&#39;:
            data=self.__get_flux_data()
            title += &#39; Flux vs Time&#39;
        elif plotUnit == &#39;counts&#39;:
            data=self.__get_counts_data()
            title += &#39; Counts vs Time&#39; 
             
        if i == 0:
            datas=data[:,0]
            plotColor = &#39;gray&#39;
        elif i == 1:
            datas=data[:,1]
            plotColor = &#39;magenta&#39;
        elif i == 2:
            datas=data[:,2]
            plotColor = &#39;lime&#39;
        elif i == 3:
            datas=data[:,3]
            plotColor = &#39;cyan&#39;
        elif i == 4:
            datas=data[:,4]
            plotColor = &#39;yellow&#39;
        elif i == 5:
            datas=data[:,5]
            plotColor = &#39;red&#39;
        
        df = pd.DataFrame(datas, index=self.TimeNew2,columns=[columns[i]])
        colors = [&#39;gray&#39;,&#39;magenta&#39;,&#39;lime&#39;, &#39;cyan&#39;, &#39;yellow&#39;, &#39;red&#39;]
        df.plot(figsize=(3, 3), drawstyle=&#39;steps-post&#39;, color = [plotColor])
        plt.yscale(&#39;log&#39;)
        plt.xlabel(&#39;Start time: &#39; + str(self.Date_start))
        plt.ylabel(xlabel)
        plt.title(title)
        if show:
            plt.show()
        if name:
            plt.savefig(name, format=&#39;png&#39;)

            
    # 2. Plot Spectrum
    def __plot_spectrum(self, typ):
        n = len(self.E_min)
        data = np.zeros(shape=n)
        # Define Rate for &#34;Plot Spectrum&#34;
        if typ == &#39;rate&#39;:
            for i in range(n):
                data[i] = np.mean(self.rate[:, i])
                plt.rcParams[&#34;figure.figsize&#34;] = [8, 8]
                plt.text(20.8146, 8.1881, &#39;Detectors: &#39; + self.detectors,
                         fontdict={&#39;fontsize&#39;: 8, &#39;fontweight&#39;: &#39;medium&#39;})
                plt.text(11.4332, 6.71774, self.Date_start + &#39; to &#39; + self.Date_end,
                         fontdict={&#39;fontsize&#39;: 8, &#39;fontweight&#39;: &#39;medium&#39;})
                plt.xlabel(&#39;Energy(keV)&#39;)
                plt.ylabel(&#39;counts/s&#39;)
                plt.title(&#39;SPEX HESSI Count Rate vs Energy&#39;)
        # Define Counts for &#34;Plot Spectrum&#34;
        elif typ == &#39;counts&#39;:
            for i in range(n):
                data[i] = np.mean(self.rate[:, i] * self.sum)
                plt.rcParams[&#34;figure.figsize&#34;] = [8, 8]
                plt.text(26, 5100, &#39;Detectors: &#39; + self.detectors, fontdict={&#39;fontsize&#39;: 8, &#39;fontweight&#39;: &#39;medium&#39;})
                plt.text(11.9, 4353.52, self.Date_start + &#39; to &#39; + self.Date_end,
                         fontdict={&#39;fontsize&#39;: 8, &#39;fontweight&#39;: &#39;medium&#39;})
                plt.xlabel(&#39;Energy(keV)&#39;)
                plt.ylabel(&#39;counts&#39;)
                plt.title(&#39;SPEX HESSI Counts vs Energy&#39;)
        # Define Flux for &#34;Plot Spectrum&#34;
        elif typ == &#39;flux&#39;:
            deltaE = np.zeros(shape=(n))
            for i in range(n):
                deltaE[i] = self.E_max[i] - self.E_min[i]

            for i in range(n):
                data[i] = np.mean(self.rate[:, i]) / (self.Area * deltaE[i]-2)
                plt.rcParams[&#34;figure.figsize&#34;] = [8, 8]
                plt.text(32, 0.029, &#39;Detectors: &#39; + self.detectors, fontdict={&#39;fontsize&#39;: 8, &#39;fontweight&#39;: &#39;medium&#39;})
                plt.text(11.9, 0.023, self.Date_start + &#39; to &#39; + self.Date_end,
                         fontdict={&#39;fontsize&#39;: 8, &#39;fontweight&#39;: &#39;medium&#39;})
                plt.xlabel(&#39;Energy(keV)&#39;)
                plt.ylabel(&#39;counts s^(-1) cm^(-2) keV^(-1)&#39;)
                plt.title(&#39;SPEX HESSI Count Flux vs Energy&#39;)
        else:
            print(&#39;error&#39;)
            return

        plt.plot(self.E_min, data, drawstyle=&#39;steps-post&#39;)
        plt.yscale(&#39;log&#39;)
        plt.xscale(&#39;log&#39;)
        plt.show()

    # Plot Spectrum for Rate, Counts, Flux
    # Spectrum for Rate
    def plot_spectrum_rate(self):
        self.__plot_spectrum(&#39;rate&#39;)

    # Spectrum for Counts
    def plot_spectrum_counts(self):
        self.__plot_spectrum(&#39;counts&#39;)

    # Spectrum for Flux
    def plot_spectrum_flux(self):
        self.__plot_spectrum(&#39;flux&#39;)

    # 3. Plot Spectrogram
    def __plot_spectrogram(self, typ):
        tick = np.array([str(timedelta(seconds=s)) for s in self.Time2])
        #X, Y = np.meshgrid(tick, self.E_min)
        # Define Rate for Plot Spectrogram
        if typ == &#39;rate&#39;:
            plt.pcolormesh(tick, self.E_min, np.transpose(self.rate), cmap=&#39;gray_r&#39;)
            # plt.xticks(np.arange(min(self.TimeNew), max(self.TimeNew), 1.0))
            plt.xlabel(&#39;Start Time: &#39; + self.Date_start)
            plt.ylabel(&#39;keV&#39;)
            plt.title(&#39;SPEX HESSI Count Rate Spectrogram&#39;)

        # Define Counts for Plot Spectrogram
        elif typ == &#39;counts&#39;:
            plt.pcolormesh(tick, self.E_min, np.transpose(self.rate) * self.sum, cmap=&#39;gray_r&#39;)
            plt.xlabel(&#39;Start Time: &#39; + self.Date_start)
            plt.ylabel(&#39;keV&#39;)
            plt.title(&#39;SPEX HESSI Counts Spectrogram&#39;)



        # Define Flux for Plot Spectrogram
        elif typ == &#39;flux&#39;:
            n = len(self.E_min)
            deltaE = np.zeros(shape=(n))
            for i in range(n):
                deltaE[i] = self.E_max[i] - self.E_min[i]
            plt.pcolormesh(tick, self.E_min, np.transpose(self.rate) / (self.Area * deltaE[i]), cmap=&#39;gray_r&#39;)
            plt.xlabel(&#39;Start Time: &#39; + self.Date_start)
            plt.ylabel(&#39;keV&#39;)
            plt.title(&#39;SPEX HESSI Count Flux Spectrogram&#39;)


        else:
            print(&#39;error&#39;)
            return
        #plt.axis([self.TimeNew2[0], self.TimeNew2[-1], 1, 1000])

        # plt.xsticks(rotation = 90)
        T = len(tick)/5
        plt.colorbar()
        plt.yscale(&#39;log&#39;)
        plt.yticks([1, 1000])
        plt.xticks(np.arange(len(tick), step = T)) # for 1st data: step = 30 # , rotation = 90)
        plt.show()


    # Plot Spectrogram
    # Spectrogram for Rate
    def plot_spectrogram_rate(self):
        self.__plot_spectrogram(&#39;rate&#39;)

    # Spectrogram for Counts
    def plot_spectrogram_counts(self):
        self.__plot_spectrogram(&#39;counts&#39;)

    # Spectrogram for Flux
    def plot_spectrogram_flux(self):
        self.__plot_spectrogram(&#39;flux&#39;)</code></pre>
</details>
<h3>Methods</h3>
<dl>
<dt id="background_plot.Input.backg_plot_vs_time"><code class="name flex">
<span>def <span class="ident">backg_plot_vs_time</span></span>(<span>self, plotUnit, i, xlabel='counts', title='SPEX HESSI Count', show=True, name=None)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def backg_plot_vs_time(self, plotUnit, i, xlabel= &#39;counts&#39;, title=&#39;SPEX HESSI Count&#39;, show=True, name=None):

    columns=[&#39;3-6keV(Data with Bk)&#39;, &#39;6-12keV(Data with Bk)&#39;, &#39;12-25keV(Data with Bk)&#39;,
                              &#39;25-49keV(Data with Bk)&#39;, &#39;49-100keV(Data with Bk)&#39;, &#39;100-250keV(Data with Bk)&#39;]
    if plotUnit == &#39;rate&#39;:
        data=self.__get_rate_data()
        title += &#39; Rate vs Time&#39;
    elif plotUnit == &#39;flux&#39;:
        data=self.__get_flux_data()
        title += &#39; Flux vs Time&#39;
    elif plotUnit == &#39;counts&#39;:
        data=self.__get_counts_data()
        title += &#39; Counts vs Time&#39; 
         
    if i == 0:
        datas=data[:,0]
        plotColor = &#39;gray&#39;
    elif i == 1:
        datas=data[:,1]
        plotColor = &#39;magenta&#39;
    elif i == 2:
        datas=data[:,2]
        plotColor = &#39;lime&#39;
    elif i == 3:
        datas=data[:,3]
        plotColor = &#39;cyan&#39;
    elif i == 4:
        datas=data[:,4]
        plotColor = &#39;yellow&#39;
    elif i == 5:
        datas=data[:,5]
        plotColor = &#39;red&#39;
    
    df = pd.DataFrame(datas, index=self.TimeNew2,columns=[columns[i]])
    colors = [&#39;gray&#39;,&#39;magenta&#39;,&#39;lime&#39;, &#39;cyan&#39;, &#39;yellow&#39;, &#39;red&#39;]
    df.plot(figsize=(3, 3), drawstyle=&#39;steps-post&#39;, color = [plotColor])
    plt.yscale(&#39;log&#39;)
    plt.xlabel(&#39;Start time: &#39; + str(self.Date_start))
    plt.ylabel(xlabel)
    plt.title(title)
    if show:
        plt.show()
    if name:
        plt.savefig(name, format=&#39;png&#39;)</code></pre>
</details>
</dd>
<dt id="background_plot.Input.counts_vs_time_plotting"><code class="name flex">
<span>def <span class="ident">counts_vs_time_plotting</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def counts_vs_time_plotting(self):
    count_data = self.__get_counts_data()

    self.__time_profile_plotting(count_data, &#39;counts&#39;, &#39;SPEX HESSI Counts vs Time&#39;)</code></pre>
</details>
</dd>
<dt id="background_plot.Input.flux_vs_time_plotting"><code class="name flex">
<span>def <span class="ident">flux_vs_time_plotting</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def flux_vs_time_plotting(self):
    flux_data = self.__get_flux_data()
    self.__time_profile_plotting(flux_data, &#39;counts s^(-1) cm^(-2) keV^(-1)&#39;, &#39;SPEX HESSI Count Flux vs Time&#39;)
    colors = [&#39;gray&#39;,&#39;magenta&#39;,&#39;lime&#39;, &#39;cyan&#39;, &#39;yellow&#39;, &#39;red&#39;]</code></pre>
</details>
</dd>
<dt id="background_plot.Input.plot_spectrogram_counts"><code class="name flex">
<span>def <span class="ident">plot_spectrogram_counts</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def plot_spectrogram_counts(self):
    self.__plot_spectrogram(&#39;counts&#39;)</code></pre>
</details>
</dd>
<dt id="background_plot.Input.plot_spectrogram_flux"><code class="name flex">
<span>def <span class="ident">plot_spectrogram_flux</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def plot_spectrogram_flux(self):
    self.__plot_spectrogram(&#39;flux&#39;)</code></pre>
</details>
</dd>
<dt id="background_plot.Input.plot_spectrogram_rate"><code class="name flex">
<span>def <span class="ident">plot_spectrogram_rate</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def plot_spectrogram_rate(self):
    self.__plot_spectrogram(&#39;rate&#39;)</code></pre>
</details>
</dd>
<dt id="background_plot.Input.plot_spectrum_counts"><code class="name flex">
<span>def <span class="ident">plot_spectrum_counts</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def plot_spectrum_counts(self):
    self.__plot_spectrum(&#39;counts&#39;)</code></pre>
</details>
</dd>
<dt id="background_plot.Input.plot_spectrum_flux"><code class="name flex">
<span>def <span class="ident">plot_spectrum_flux</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def plot_spectrum_flux(self):
    self.__plot_spectrum(&#39;flux&#39;)</code></pre>
</details>
</dd>
<dt id="background_plot.Input.plot_spectrum_rate"><code class="name flex">
<span>def <span class="ident">plot_spectrum_rate</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def plot_spectrum_rate(self):
    self.__plot_spectrum(&#39;rate&#39;)</code></pre>
</details>
</dd>
<dt id="background_plot.Input.rate_vs_time_plotting"><code class="name flex">
<span>def <span class="ident">rate_vs_time_plotting</span></span>(<span>self)</span>
</code></dt>
<dd>
<section class="desc"></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def rate_vs_time_plotting(self):
    rate_data = self.__get_rate_data()
    self.__time_profile_plotting(rate_data, &#39;counts/s&#39;, &#39;SPEX HESSI Count Rate vs Time&#39;)</code></pre>
</details>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="background_plot.Input" href="#background_plot.Input">Input</a></code></h4>
<ul class="">
<li><code><a title="background_plot.Input.backg_plot_vs_time" href="#background_plot.Input.backg_plot_vs_time">backg_plot_vs_time</a></code></li>
<li><code><a title="background_plot.Input.counts_vs_time_plotting" href="#background_plot.Input.counts_vs_time_plotting">counts_vs_time_plotting</a></code></li>
<li><code><a title="background_plot.Input.flux_vs_time_plotting" href="#background_plot.Input.flux_vs_time_plotting">flux_vs_time_plotting</a></code></li>
<li><code><a title="background_plot.Input.plot_spectrogram_counts" href="#background_plot.Input.plot_spectrogram_counts">plot_spectrogram_counts</a></code></li>
<li><code><a title="background_plot.Input.plot_spectrogram_flux" href="#background_plot.Input.plot_spectrogram_flux">plot_spectrogram_flux</a></code></li>
<li><code><a title="background_plot.Input.plot_spectrogram_rate" href="#background_plot.Input.plot_spectrogram_rate">plot_spectrogram_rate</a></code></li>
<li><code><a title="background_plot.Input.plot_spectrum_counts" href="#background_plot.Input.plot_spectrum_counts">plot_spectrum_counts</a></code></li>
<li><code><a title="background_plot.Input.plot_spectrum_flux" href="#background_plot.Input.plot_spectrum_flux">plot_spectrum_flux</a></code></li>
<li><code><a title="background_plot.Input.plot_spectrum_rate" href="#background_plot.Input.plot_spectrum_rate">plot_spectrum_rate</a></code></li>
<li><code><a title="background_plot.Input.rate_vs_time_plotting" href="#background_plot.Input.rate_vs_time_plotting">rate_vs_time_plotting</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.7.2</a>.</p>
</footer>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad()</script>
</body>
</html>